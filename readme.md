# WPCompat

WPCompat is a PHPStan extension which helps verify that your PHP code is compatible with a given version of WordPress. You can use it to help ensure that your plugin or theme remains compatible with its "Requires at least" version.

It works by checking the `@since` version of any WordPress functions or class methods that are in use is lower than or equal to the minimum version of WordPress that your code supports. For example, if your plugin supports WordPress 6.0 or higher but the `get_template_hierarchy()` function is used unconditionally, the extension will trigger an error because that function was only introduced in WordPress 6.1. If the code is guarded with a `function_exists( 'get_template_hierarchy' )` check then an error won't be triggered.

## Status

WPCompat is a brand new extension and is far from exhaustive in its checks. It can be used but you'll almost certainly get some false positives, particularly around method usage.

## Requirements

* PHPStan 12 or higher
* PHP 7.4 or higher (tested up to PHP 8.4)

## Installation

```shell
composer require --dev johnbillion/wp-compat
```

If you also install [phpstan/extension-installer](https://github.com/phpstan/extension-installer) then you're all set!

<details>
  <summary>Manual installation</summary>

If you don't want to use `phpstan/extension-installer`, include extension.neon in your project's PHPStan config:

```
includes:
    - vendor/johnbillion/wp-compat/extension.neon
```
</details>

## Tools

### PHPStan extension

A PHPStan extension which determines if your code is compatible with any given version of WordPress based on the symbols that it uses.

### symbols.json

The [symbols.json](symbols.json) file contains a dictionary of all functions and methods in WordPress along with the version of WordPress in which they were introduced.

The file can be regenerated by running:

```shell
composer generate
```

The JSON schema for the file can be found in [schemas/symbols.json](schemas/symbols.json).

## License

MIT
